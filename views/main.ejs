<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title><%= title %></title>
  <link rel="stylesheet" href="/layui_dist/css/layui.css">
  <link rel="stylesheet" href="/stylesheets/bodystyle.css">
</head>
<body class="layui-layout-body">
<div class="layui-layout layui-layout-admin">
  <div class="layui-header">
    <a href="/"><div class="layui-logo"><%= title %></div></a>
    <!-- 头部区域（可配合layui已有的水平导航） -->
    <ul class="layui-nav layui-layout-right">
      <li class="layui-nav-item">
        <a href="javascript:;">
          <img src="http://t.cn/RCzsdCq" class="layui-nav-img">
          贤心
        </a>
        <dl class="layui-nav-child">
          <dd><a href="">基本资料</a></dd>
          <dd><a href="">安全设置</a></dd>
        </dl>
      </li>
      <li class="layui-nav-item"><a href="">退了</a></li>
    </ul>
  </div>
  
  <div class="layui-side layui-bg-black">
    <div class="layui-side-scroll">
      <!-- 左侧导航区域（可配合layui已有的垂直导航） -->
      <ul class="layui-nav layui-nav-tree"  lay-filter="test">
        <li class="layui-nav-item layui-nav-itemed">
          <a class="" href="javascript:;">人力资源管理</a>
          <dl class="layui-nav-child">
            <dd><a href="/humanresource">人员列表</a></dd>
            <dd><a href="/project">项目列表</a></dd>
            <dd><a href="/arrangement">人力安排</a></dd>
            <dd><a href="/hrChart">计划总览</a></dd>
          </dl>
        </li>
        <li class="layui-nav-item">
          <a href="javascript:;">工时统计</a>
          <dl class="layui-nav-child">
            <dd><a href="javascript:;">子列表占位符一</a></dd>
            <dd><a href="javascript:;">子列表占位符二</a></dd>
          </dl>
        </li>
      </ul>
    </div>
  </div>
  
  <div class="layui-body">
    <!-- 内容主体区域 -->
    <div class="indexBackground layui-col-space20">
      <div class="layui-col-md4">
        <div class="dateChoose layui-card">
          <div class="layui-card-header">时间选择</div>
          <div class="layui-card-body">
            <div class="layui-inline" id="dateChoose"></div>
          </div>
        </div>
        <div class="layui-card">
          <div class="layui-card-header">工程提醒</div>
          <div class="layui-card-body"> <!-- CHANGE TO HR -->
            最近正在进行的项目有：
          </div>
        </div>
      </div>
      <div class="layui-col-md8">
        <div class="dataCollect layui-card">
          <div class="layui-card-header">数据统计</div>
          <div class="layui-card-body">
            <div id="dataInDay" style="width: 100%;height:100%;">
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="layui-footer">
    <!-- 底部固定区域 -->
    © layui.com - 底部固定区域
  </div>
</div>
<script src="/layui_dist/layui.js"></script>
<script src="/echarts_dist/echarts.js"></script>
<script>
//Layui组件渲染代码区域
layui.use(['laydate','jquery'],function(){
  var laydate = layui.laydate;
  var $ = layui.$;
  laydate.render({
    elem:"#dateChoose"
    ,position: 'static'
    ,showBottom: false
    ,done: function(value) {
      var targetDate = parseInt(value.slice(0,4)) * 10000 + parseInt(value.slice(5,7)) * 100 + parseInt(value.slice(8,10));
      $.ajax({
        url:'/stastics/statusInDay',
        type:'get',
        data:{date:targetDate},
        dataType:'json',
        success:function(data){
            option.dataset.source = data;
            chartInMain.setOption(option);
        }
      })
      console.log(value);
    }
  });
});
layui.use('element', function(){
  var element = layui.element;
  
});

// Echarts组件渲染
var chartInMain = echarts.init(document.getElementById('dataInDay'));
var option = {
    title:{text: '当日人力资源数据'},
    legend: {},
    tooltip: {},
    dataset: {
        source: [
      ['组别', '领班','排故工程师','ME/CB','AV','STR','工卡与计划室'],
      ['在岗',0,0,0,0,0,0],
      ['请假',0,0,0,0,0,0],
      ['培训',0,0,0,0,0,0]] 
    },
    xAxis: {type: 'category'},
    yAxis: {},
    // Declare several bar series, each will be mapped
    // to a column of dataset.source by default.
    series: [
        {type: 'bar'},
        {type: 'bar'},
        {type: 'bar'},
        {type: 'bar'},
        {type: 'bar'},
        {type: 'bar'}
    ]
};
chartInMain.setOption(option);
</script>
</body>
</html>